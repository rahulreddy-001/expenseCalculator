<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expense_Calculator</title>
    <link
			rel="stylesheet"
			href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
			integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
			crossorigin="anonymous"
	/>
    <script
        defer
        src="https://use.fontawesome.com/releases/v5.7.2/js/all.js"
        integrity="sha384-0pzryjIRos8mFBWMzSSZApWtPl/5++eIfzYmTgBBmXYdhvxPc+XcFEk+zJwDgWbP"
        crossorigin="anonymous"
    ></script>
</head>
<body>
    <nav class="navbar navbar-dark bg-dark">
        <span class="navbar-brand mb-0 h1">Expense Calculator</span>
        <span class="navbar-brand mb-0 h1" id="totalExpense"></span>
    </nav>
    <div class="container-fluid bg-light" style="min-height: 100vh">
        <div class="container">
            <div class="jumbotron mt-4">
                <div class="input-group mb-3">
                    <input
                        type="text"
                        class="form-control"
                        placeholder="Amount spent"
                        aria-label="Amount spent"
                        aria-describedby="spent in rupee"
                        id="inputExpense"
                    />
                    <div class="input-group-append">
                        <span class="input-group-text" id="spent in rupee">â‚¹</span>
                    </div>
                </div>
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="spent at">@</span>
                    </div>
                    <input
                        type="text"
                        class="form-control"
                        placeholder="spent On"
                        aria-label="spent On"
                        aria-describedby="spent at"
                        id="inputDes"
                    />
                    <div class="input-group-append">
                        <button class="btn btn-outline-primary" type="button" id="addBtn">Add</button>
                    </div>
                </div>
        </div>
        <div>
            <ul class="list-group" id="expenseTable">
            </ul>
        </div>
    </div>
  
    <script>
        const addBtn= document.querySelector("#addBtn");
        const inputExpense=document.querySelector("#inputExpense");
        const displayExpense=document.querySelector("#totalExpense");
        const inputDesEl=document.querySelector("#inputDes");
        const expenseTableEl=document.querySelector("#expenseTable");

        var totalExpense=0;
        var expenseDes="Nan";
        var expenseArr=[];
        var newExpenseArr=[];
        var textOutput=`Total Expense :${totalExpense}`;
        displayExpense.textContent= textOutput;

        function addExpense(){
            var readExpense=inputExpense.value;
            var expenseObj={};
            expenseDes=inputDesEl.value;
            readExpense=parseInt(readExpense);
            totalExpense=totalExpense+readExpense;
            
            textOutput=`Total Expense :${totalExpense}`;
            displayExpense.textContent= textOutput;

            expenseObj.item=expenseDes;
            expenseObj.amount=readExpense;
            expenseObj.moment=new Date();
            expenseArr.push(expenseObj);
            inputDesEl.value="";
            inputExpense.value="";
            renderList(expenseArr);

        }
        function deleteItem(dateValue)
        {
            var reqExpenseArr=expenseArr.filter(expense=> expense.moment.valueOf() === dateValue)
            
            totalExpense=totalExpense-reqExpenseArr[0].amount;
            
            textOutput=`Total Expense :${totalExpense}`;
            displayExpense.textContent= textOutput;

            newExpenseArr=expenseArr.filter(expense=> expense.moment.valueOf() !== dateValue)
            expenseArr=newExpenseArr;
            renderList(expenseArr);
        }
        function renderList(arr)
        {
            const allExpenseHTML= expenseArr.map(expenseObj=>getInnerHTML(expenseObj));
            function getInnerHTML({item,amount,moment})
            {
                return `<li class="list-group-item d-flex justify-content-between">
                            <div class="d-flex flex-column">
                                ${item}
                                <small class="text-muted">${DateInRequriedFormat(moment)}</small>
                            </div>
                            <div>
                                <span class="px-5">
                                    ${amount}
                                </span>
                                <button 
                                    type="button" 
                                    class="btn btn-outline-danger btn-sm"
                                    onclick="deleteItem(${moment.valueOf()})"
                                >
                                    <i class="fas fa-trash-alt"></i>
                                </button>
                            </div>
                        </li>`;
            }
            
        
            const joinedAllExpenseHTML=allExpenseHTML.join("");
            expenseTableEl.innerHTML=joinedAllExpenseHTML; 
        }
        function DateInRequriedFormat(moment)
        {
            return moment.toLocaleDateString('en-US',
            {
                year:'numeric',
                month:'long',
                day:'numeric',
            })
        }
        inputDesEl.addEventListener("keyup",function(e){
            if(e.keyCode==13){
                addBtn.click();
            }
        });
        addBtn.addEventListener("click",addExpense,"flase");
    </script>
</body>
</html>
